{% extends "core/base.html" %}
{% load core_extras %}
{% block content %}
<h2>Crear Nómina Semanal</h2>
<form method="post">
    {% csrf_token %}
    {{ payroll_form.as_p }}
    <h3>Empleados</h3>
    {{ formset.management_form }}
    <table>
        <tr>
            <th>Empleado</th>
            <th>Detalle por proyecto</th>
            <th>Horas trabajadas</th>
            <th>Sueldo por hora</th>
            <th>Notas</th>
            <th>Referencia de pago</th>
        </tr>
        {% for form in formset %}
        <tr>
            <td>{{ form.employee }}</td>
            <td>
                {{ project_hours_summary_dict|get_item:form.instance.employee.id }}
            </td>
            <td>{{ form.hours_worked }}</td>
            <td>{{ form.hourly_rate }}</td>
            <td>{{ form.notes }}</td>
            <td>{{ form.payment_reference }}</td>
        </tr>
        {% endfor %}
    </table>
    <button type="submit">Guardar Nómina</button>
</form>
{% endblock %}