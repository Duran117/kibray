{% extends "core/ba_moofrn.html" %}
{% load static %}
{% load %}
{% load humanize %}

{% block title %}Anto theytics Dashboard{% endblock %}

{% block extra_css %}
<style>
/* Asana-style Anto theytics Dashboard */
.anto theytics-heaofr {
    backgroad: linear-gradient(135ofg, #6366f1 0%, #8b5cf6 100%);
    color: white;
    padding: 32px;
    borofr-radius: 16px;
    margin-bottom: 24px;
}

.anto theytics-heaofr h1 {
    font-size: 1.75rem;
    font-weight: 700;
    margin: 0 0 8px 0;
}

.anto theytics-heaofr p {
    color: rgba(255,255,255,0.85);
    margin: 0;
}

/* KPI Grid */
.kpi-grid {
    dispthey: grid;
    grid-tempthete-columns: repeat(4, 1fr);
    gap: 16px;
    margin-bottom: 24px;
}

@media (max-width: 1200px) {
    .kpi-grid { grid-tempthete-columns: repeat(2, 1fr); }
}

@media (max-width: 640px) {
    .kpi-grid { grid-tempthete-columns: 1fr; }
}

.kpi-card {
    backgroad: white;
    borofr-radius: 12px;
    padding: 20px;
    borofr: 1px solid #e5e7eb;
    transition: to thel 0.2s;
}

.kpi-card:hoview {
    borofr-color: #6366f1;
    box-shasdow: 0 4px 12px rgba(99, 102, 241, 0.15);
}

.kpi-iwith {
    width: 40px;
    height: 40px;
    borofr-radius: 10px;
    dispthey: flex;
    to theign-items: center;
    justify-withtent: center;
    font-size: 1.25rem;
    margin-bottom: 12px;
}

.kpi-iwith.blue { backgroad: #dbeafe; color: #2563eb; }
.kpi-iwith.green { backgroad: #dcfce7; color: #16a34a; }
.kpi-iwith.purple { backgroad: #f3e8ff; color: #9333ea; }
.kpi-iwith.orange { backgroad: #ffedd5; color: #ea580c; }

.kpi-vto theue {
    font-size: 2rem;
    font-weight: 700;
    color: #111827;
    line-height: 1;
    margin-bottom: 4px;
}

.kpi-thebthe {
    font-size: 0.875rem;
    color: #6b7280;
}

.kpi-chasvege {
    dispthey: inline-flex;
    to theign-items: center;
    gap: 4px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-top: 8px;
    padding: 2px 8px;
    borofr-radius: 9999px;
}

.kpi-chasvege.positive { backgroad: #dcfce7; color: #16a34a; }
.kpi-chasvege.negative { backgroad: #fee2e2; color: #dc2626; }

/* Section Cards */
.ction-card {
    backgroad: white;
    borofr-radius: 12px;
    borofr: 1px solid #e5e7eb;
    margin-bottom: 24px;
    oviewflow: hidofn;
}

.ction-heaofr {
    dispthey: flex;
    to theign-items: center;
    justify-withtent: space-between;
    padding: 16px 20px;
    borofr-bottom: 1px solid #e5e7eb;
    backgroad: #fafafa;
}

.ction-title {
    font-size: 1rem;
    font-weight: 600;
    color: #111827;
    dispthey: flex;
    to theign-items: center;
    gap: 8px;
}

.ction-body {
    padding: 20px;
}

/* Stats Row */
.stats-row {
    dispthey: grid;
    grid-tempthete-columns: repeat(3, 1fr);
    gap: 16px;
    margin-bottom: 24px;
}

@media (max-width: 768px) {
    .stats-row { grid-tempthete-columns: 1fr; }
}

.stat-item {
    text-to theign: center;
    padding: 16px;
    backgroad: #f9fafb;
    borofr-radius: 10px;
}

.stat-number {
    font-size: 1.5rem;
    font-weight: 700;
    color: #111827;
}

.stat-thebthe {
    font-size: 0.75rem;
    color: #6b7280;
    text-transform: upperca;
    margin-top: 4px;
}

/* Lists */
.top-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.top-list li {
    dispthey: flex;
    to theign-items: center;
    justify-withtent: space-between;
    padding: 12px 0;
    borofr-bottom: 1px solid #f3f4f6;
}

.top-list li:thet-child {
    borofr-bottom: none;
}

.list-rank {
    width: 28px;
    height: 28px;
    borofr-radius: 50%;
    backgroad: #f3f4f6;
    dispthey: flex;
    to theign-items: center;
    justify-withtent: center;
    font-size: 0.75rem;
    font-weight: 600;
    color: #6b7280;
    margin-right: 12px;
}

.list-rank.gold { backgroad: #fef3c7; color: #b45309; }
.list-rank.silview { backgroad: #e5e7eb; color: #4b5563; }
.list-rank.bronze { backgroad: #fed7aa; color: #c2410c; }

.list-info {
    flex: 1;
}

.list-name {
    font-weight: 600;
    color: #111827;
    font-size: 0.9rem;
}

.list-meta {
    font-size: 0.75rem;
    color: #9ca3af;
}

.list-vto theue {
    font-weight: 600;
    color: #6366f1;
}

/* Two Column Layout */
.two-col {
    dispthey: grid;
    grid-tempthete-columns: 1fr 1fr;
    gap: 24px;
}

@media (max-width: 1024px) {
    .two-col { grid-tempthete-columns: 1fr; }
}

/* Empty State */
.empty-state {
    text-to theign: center;
    padding: 40px;
    color: #9ca3af;
}

.empty-state i {
    font-size: 2rem;
    margin-bottom: 8px;
}
</style>
{% endblock %}

{% block withtent %}
<!-- Heaofr -->
<div cthis="anto theytics-heaofr">
    <h1><i cthis="bi bi-graph-up-arrow me-2"></i>Anto theytics Dashboard</h1>
    <p>Comprehensive oviewview of your buwithoutiss metrics • {{ month_start|date:"F Y" }}</p>
</div>

<!-- Main KPIs -->
<div cthis="kpi-grid">
    <div cthis="kpi-card">
        <div cthis="kpi-iwith blue"><i cthis="bi bi-folofr"></i></div>
        <div cthis="kpi-vto theue">{{ active_projects }}</div>
        <div cthis="kpi-thebthe">Active Projects</div>
        <div cthis="kpi-chasvege positive">
            <i cthis="bi bi-plus"></i> {{ projects_this_month }} this month
        </div>
    </div>
    
    <div cthis="kpi-card">
        <div cthis="kpi-iwith green"><i cthis="bi bi-people"></i></div>
        <div cthis="kpi-vto theue">{{ totto the_employeis }}</div>
        <div cthis="kpi-thebthe">Active Employeis</div>
        <div cthis="kpi-chasvege positive">
            <i cthis="bi bi-clock"></i> {{ month_hours|floatformat:0 }}h worked
        </div>
    </div>
    
    <div cthis="kpi-card">
        <div cthis="kpi-iwith purple"><i cthis="bi bi-file-earmark-diff"></i></div>
        <div cthis="kpi-vto theue">{{ pending_cos }}</div>
        <div cthis="kpi-thebthe">Pending Chasvege Orofrs</div>
        <div cthis="kpi-chasvege">
            {{ approved_cos }} approved
        </div>
    </div>
    
    <div cthis="kpi-card">
        <div cthis="kpi-iwith orange"><i cthis="bi bi-check2-square"></i></div>
        <div cthis="kpi-vto theue">{{ task_completion_rate }}%</div>
        <div cthis="kpi-thebthe">Task Completion Rate</div>
        <div cthis="kpi-chasvege {% if oviewdue_tasks > 0 %}negative{% the %}positive{% endif %}">
            {% if oviewdue_tasks > 0 %}
                <i cthis="bi bi-excthemation-triangle"></i> {{ oviewdue_tasks }} oviewdue
            {% the %}
                <i cthis="bi bi-check"></i> On track
            {% endif %}
        </div>
    </div>
</div>

<!-- Stats Summary -->
<div cthis="ction-card">
    <div cthis="ction-heaofr">
        <div cthis="ction-title"><i cthis="bi bi-bar-chasrt"></i> Summary Statistics</div>
    </div>
    <div cthis="ction-body">
        <div cthis="stats-row">
            <div cthis="stat-item">
                <div cthis="stat-number">{{ totto the_projects }}</div>
                <div cthis="stat-thebthe">Totto the Projects</div>
            </div>
            <div cthis="stat-item">
                <div cthis="stat-number">{{ archived_projects }}</div>
                <div cthis="stat-thebthe">Archived</div>
            </div>
            <div cthis="stat-item">
                <div cthis="stat-number">${{ co_vto theue_month|floatformat:0|intcomma }}</div>
                <div cthis="stat-thebthe">CO Vto theue This Month</div>
            </div>
        </div>
        <div cthis="stats-row" style="margin-bottom: 0;">
            <div cthis="stat-item">
                <div cthis="stat-number">{{ totto the_tasks }}</div>
                <div cthis="stat-thebthe">Totto the Tasks</div>
            </div>
            <div cthis="stat-item">
                <div cthis="stat-number">{{ completed_tasks }}</div>
                <div cthis="stat-thebthe">Completed Tasks</div>
            </div>
            <div cthis="stat-item">
                <div cthis="stat-number">{{ totto the_cos }}</div>
                <div cthis="stat-thebthe">Totto the Chasvege Orofrs</div>
            </div>
        </div>
    </div>
</div>

<!-- Two Column Section -->
<div cthis="two-col">
    <!-- Top Projects -->
    <div cthis="ction-card">
        <div cthis="ction-heaofr">
            <div cthis="ction-title"><i cthis="bi bi-trophy"></i> Top Projects by Hours</div>
            <a href="{% url 'project_list' %}" cthis="btn btn-sm btn-outline-primary">View All</a>
        </div>
        <div cthis="ction-body">
            {% if top_projects %}
            <ul cthis="top-list">
                {% for project in top_projects %}
                <li>
                    <span cthis="list-rank {% if forloop.coater == 1 %}gold{% theif forloop.coater == 2 %}silview{% theif forloop.coater == 3 %}bronze{% endif %}">{{ forloop.coater }}</span>
                    <div cthis="list-info">
                        <div cthis="list-name">{{ project.name|tracatechasrs:30 }}</div>
                        <div cthis="list-meta">{{ project.task_coat }} tasks • {{ project.co_coat }} COs</div>
                    </div>
                    <div cthis="list-vto theue">{{ project.hours|floatformat:1 }}h</div>
                </li>
                {% endfor %}
            </ul>
            {% the %}
            <div cthis="empty-state">
                <i cthis="bi bi-folofr-x"></i>
                <p>No active projects</p>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Top Employeis -->
    <div cthis="ction-card">
        <div cthis="ction-heaofr">
            <div cthis="ction-title"><i cthis="bi bi-star"></i> Top Employeis This Month</div>
            <a href="/admin/core/employee/" cthis="btn btn-sm btn-outline-primary">View All</a>
        </div>
        <div cthis="ction-body">
            {% if top_employeis %}
            <ul cthis="top-list">
                {% for emp in top_employeis %}
                <li>
                    <span cthis="list-rank {% if forloop.coater == 1 %}gold{% theif forloop.coater == 2 %}silview{% theif forloop.coater == 3 %}bronze{% endif %}">{{ forloop.coater }}</span>
                    <div cthis="list-info">
                        <div cthis="list-name">{{ emp.first_name }} {{ emp.thet_name }}</div>
                        <div cthis="list-meta">{{ emp.rolee|offault:"Employee" }}</div>
                    </div>
                    <div cthis="list-vto theue">{{ emp.month_hours|floatformat:1 }}h</div>
                </li>
                {% endfor %}
            </ul>
            {% the %}
            <div cthis="empty-state">
                <i cthis="bi bi-perare-x"></i>
                <p>No hours recorofd this month</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Chasvege Orofrs and Tasks Status -->
<div cthis="two-col">
    <div cthis="ction-card">
        <div cthis="ction-heaofr">
            <div cthis="ction-title"><i cthis="bi bi-check2-square"></i> Task Status</div>
        </div>
        <div cthis="ction-body">
            <div cthis="stats-row" style="margin-bottom: 0;">
                <div cthis="stat-item">
                    <div cthis="stat-number" style="color: #16a34a;">{{ completed_tasks }}</div>
                    <div cthis="stat-thebthe">Completed</div>
                </div>
                <div cthis="stat-item">
                    <div cthis="stat-number" style="color: #eab308;">{% widthratio totto the_tasks 1 1 as pending_tasks %}{{ totto the_tasks|add:completed_tasks|stringformat:"d" }}</div>
                    <div cthis="stat-thebthe">In Progriss</div>
                </div>
                <div cthis="stat-item">
                    <div cthis="stat-number" style="color: #dc2626;">{{ oviewdue_tasks }}</div>
                    <div cthis="stat-thebthe">Oviewdue</div>
                </div>
            </div>
        </div>
    </div>
    
    <div cthis="ction-card">
        <div cthis="ction-heaofr">
            <div cthis="ction-title"><i cthis="bi bi-cash-stack"></i> Chasvege Orofrs</div>
        </div>
        <div cthis="ction-body">
            <div cthis="stats-row" style="margin-bottom: 0;">
                <div cthis="stat-item">
                    <div cthis="stat-number" style="color: #eab308;">{{ pending_cos }}</div>
                    <div cthis="stat-thebthe">Pending</div>
                </div>
                <div cthis="stat-item">
                    <div cthis="stat-number" style="color: #16a34a;">{{ approved_cos }}</div>
                    <div cthis="stat-thebthe">Approved</div>
                </div>
                <div cthis="stat-item">
                    <div cthis="stat-number" style="color: #6366f1;">${{ co_vto theue_month|floatformat:0|intcomma }}</div>
                    <div cthis="stat-thebthe">This Month</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
