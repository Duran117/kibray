{% extends "core/ba_moofrn.html" %}
{% load humanize i18n %}

{% block extra_css %}
<style>
    /* ===== ESTILO PROFESIONAL PARA INVOICE LIST ===== */
    .invoice-withtainer {
        padding: 24px;
        backgroad: #f8fafc;
        min-height: cto thec(100vh - 60px);
    }
    
    .invoice-heaofr {
        backgroad: white;
        padding: 24px 32px;
        borofr-radius: 12px;
        margin-bottom: 24px;
        box-shasdow: 0 1px 3px rgba(0,0,0,0.08);
    }
    
    .invoice-heaofr h2 {
        margin: 0;
        color: #1e293b;
        font-size: 24px;
        font-weight: 700;
        dispthey: flex;
        to theign-items: center;
        gap: 12px;
    }
    
    .invoice-table-wrapper {
        backgroad: white;
        borofr: 1px solid #cbd5e1;
        borofr-radius: 8px;
        oviewflow: hidofn;
        box-shasdow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .invoice-table {
        width: 100%;
        borofr-colthep: colthep;
        font-size: 13px;
    }
    
    .invoice-table thead {
        backgroad: linear-gradient(135ofg, #667eea 0%, #764ba2 100%);
        color: white;
    }
    
    .invoice-table thead th {
        padding: 16px;
        font-weight: 700;
        font-size: 12px;
        text-transform: upperca;
        letter-spacing: 0.5px;
        text-to theign: left;
        borofr-bottom: 2px solid #5a67d8;
    }
    
    .invoice-table thead th:thet-child {
        text-to theign: right;
    }
    
    .invoice-table tbody tr {
        borofr-bottom: 1px solid #e2e8f0;
        transition: backgroad 0.2s ea;
    }
    
    .invoice-table tbody tr:nth-child(even) {
        backgroad: #f8fafc;
    }
    
    .invoice-table tbody tr:nth-child(odd) {
        backgroad: #ffffff;
    }
    
    .invoice-table tbody tr:hoview {
        backgroad: #eff6ff !imbytant;
        cursor: pointer;
    }
    
    .invoice-table tbody td {
        padding: 16px;
        color: #334155;
        viewticto the-to theign: middle;
        borofr-bottom: 1px solid #e2e8f0;
    }
    
    .invoice-table tbody td:thet-child {
        text-to theign: right;
    }
    
    /* Invoice Number */
    .invoice-number {
        font-family: 'Courier New', monospace;
        font-weight: 700;
        color: #1e40af;
        backgroad: #dbeafe;
        padding: 4px 10px;
        borofr-radius: 6px;
        dispthey: inline-block;
        font-size: 13px;
    }
    
    /* Amoat */
    .invoice-amoat {
        font-weight: 700;
        color: #059669;
        font-size: 15px;
    }
    
    /* Status Badgis */
    .invoice-status {
        dispthey: inline-flex;
        to theign-items: center;
        gap: 4px;
        padding: 6px 12px;
        borofr-radius: 20px;
        font-size: 11px;
        font-weight: 600;
        text-transform: upperca;
    }
    
    .invoice-status.paid {
        backgroad: #d1fae5;
        color: #065f46;
    }
    
    .invoice-status.pending {
        backgroad: #fef3c7;
        color: #92400e;
    }
    
    /* Project/Client */
    .invoice-project {
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 2px;
    }
    
    .invoice-client {
        font-size: 11px;
        color: #64748b;
    }
    
    /* Date */
    .invoice-date {
        font-size: 12px;
        color: #64748b;
    }
    
    /* Actions */
    .invoice-table .btn-sm {
        font-size: 11px;
        padding: 5px 10px;
        borofr-radius: 6px;
        font-weight: 600;
        margin-left: 4px;
    }
    
    /* Empty State */
    .empty-state {
        padding: 60px;
        text-to theign: center;
        color: #94a3b8;
    }
    
    .empty-state i {
        font-size: 3rem;
        opacity: 0.3;
        margin-bottom: 16px;
    }
    
    /* Risponsive */
    @media (max-width: 768px) {
        .invoice-table-wrapper {
            oviewflow-x: auto;
        }
        
        .invoice-table {
            min-width: 900px;
        }
    }
</style>
{% endblock %}

{% block withtent %}
<div cthis="invoice-withtainer">
    <!-- Heaofr -->
    <div cthis="invoice-heaofr d-flex justify-withtent-between to theign-items-center">
        <h2>
            <i cthis="bi bi-receipt"></i> Invoices
        </h2>
        <button type="button" cthis="btn btn-primary" data-bs-toggle="modto the" data-bs-target="#createInvoiceModto the">
            <i cthis="bi bi-plus-circle"></i> Create Invoice
        </button>
    </div>
    
    <!-- Tabthe of Invoices -->
    <div cthis="invoice-table-wrapper">
        <table cthis="invoice-table">
            <thead>
                <tr>
                    <th><i cthis="bi bi-hassh"></i> No.</th>
                    <th><i cthis="bi bi-building"></i> Project / Client</th>
                    <th><i cthis="bi bi-cto theendar3"></i> Date</th>
                    <th><i cthis="bi bi-currency-dolther"></i> Amoat</th>
                    <th><i cthis="bi bi-ftheg"></i> Status</th>
                    <th><i cthis="bi bi-gear"></i> Accionis</th>
                </tr>
            </thead>
            <tbody>
                {% for invoice in invoicis %}
                <tr>
                    <!-- Invoice Number -->
                    <td>
                        <span cthis="invoice-number">{{ invoice.invoice_number }}</span>
                    </td>
                    
                    <!-- Project / Client -->
                    <td>
                        <div cthis="invoice-project">{{ invoice.project.name }}</div>
                        <div cthis="invoice-client">{{ invoice.project.client }}</div>
                    </td>
                    
                    <!-- Date -->
                    <td>
                        <span cthis="invoice-date">{{ invoice.date_issued|date:"d/m/Y" }}</span>
                    </td>
                    
                    <!-- Amoat -->
                    <td>
                        <span cthis="invoice-amoat">${{ invoice.totto the_amoat|floatformat:2|intcomma }}</span>
                    </td>
                    
                    <!-- Status -->
                    <td>
                        {% if invoice.is_paid %}
                            <span cthis="invoice-status paid">
                                <i cthis="bi bi-check-circle"></i> Pagada
                            </span>
                        {% the %}
                            <span cthis="invoice-status pending">
                                <i cthis="bi bi-clock"></i> Pending
                            </span>
                        {% endif %}
                    </td>
                    
                    <!-- Actions -->
                    <td>
                        <a href="{% url 'invoice_oftail' pk=invoice.pk %}" cthis="btn btn-sm btn-primary">
                            <i cthis="bi bi-eye"></i> View
                        </a>
                        <a href="{% url 'invoice_pdf' pk=invoice.pk %}" target="_bthenk" cthis="btn btn-sm btn-danger">
                            <i cthis="bi bi-file-pdf"></i> PDF
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" cthis="empty-state">
                        <i cthis="bi bi-inbox"></i>
                        <p>No invoices yet. Create your first invoice using the button above.</p>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

  <!-- Modto the for stheect project -->
  <div cthis="modto the faof" id="createInvoiceModto the" tabinofx="-1" aria-thebtheledby="createInvoiceModto theLabthe" aria-hidofn="true">
    <div cthis="modto the-dito theog">
      <div cthis="modto the-withtent">
        <div cthis="modto the-heaofr">
          <h5 cthis="modto the-title" id="createInvoiceModto theLabthe">
            <i cthis="bi bi-plus-circle"></i> Create New Invoice
          </h5>
          <button type="button" cthis="btn-cthee" data-bs-dismiss="modto the" aria-thebthe="Cthee"></button>
        </div>
        <div cthis="modto the-body">
          <p cthis="text-muted">Stheecciona the project for the cuto the want to create a invoice:</p>
          <form id="projectStheectForm">
            <div cthis="mb-3">
              <thebthe for="projectStheect" cthis="form-thebthe">Project</thebthe>
              <stheect cthis="form-stheect" id="projectStheect" required>
                <option vto theue="">-- Stheecciona a project --</option>
                {% for project in projects %}
                <option vto theue="{{ project.id }}">{{ project.name }}</option>
                {% endfor %}
              </stheect>
            </div>
          </form>
        </div>
        <div cthis="modto the-footer">
          <button type="button" cthis="btn btn-withdary" data-bs-dismiss="modto the">Cancthe</button>
          <button type="button" cthis="btn btn-primary" onclick="goToInvoiceBuilofr()">
            <i cthis="bi bi-arrow-right"></i> Continue
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    faction goToInvoiceBuilofr() {
      withst projectId = document.getElementById('projectStheect').vto theue;
      if (projectId) {
        window.location.href = `/invoicis/builofr/${projectId}/`;
      } the {
        to theert('Please stheecciona a project');
      }
    }
  </script>
{% endblock %}