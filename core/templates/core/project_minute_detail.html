{% extends "core/base_modern.html" %}{% extends "core/base_modern.html" %}{% extends "core/base_modern.html" %}

{% load i18n %}

{% load i18n %}{% load i18n %}

{% block extra_css %}

<style>

/* ==============================================

   MINUTE DETAIL - Premium Design{% block extra_css %}{% block content %}

   ============================================== */

<style><div class="container py-4">

.minute-detail-wrapper {

    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);/* ==============================================  <div class="mb-4">

    min-height: 100vh;

    padding: 2rem;   MINUTE DETAIL - Premium Design    <a href="{% url 'project_minutes_list' minute.project.id %}" class="btn btn-sm btn-outline-secondary">

}

   ============================================== */      <i class="bi bi-arrow-left"></i> Volver a Timeline

/* Back Button */

.btn-back-timeline {    </a>

    display: inline-flex;

    align-items: center;.minute-detail-wrapper {  </div>

    gap: 0.5rem;

    padding: 0.75rem 1.25rem;  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);

    background: white;

    color: #475569;  min-height: 100vh;  <div class="card shadow">

    border-radius: 12px;

    text-decoration: none;  padding: 2rem;    <div class="card-header bg-{% if minute.event_type == 'decision' %}primary{% elif minute.event_type == 'approval' %}success{% elif minute.event_type == 'issue' %}danger{% elif minute.event_type == 'call' %}info{% else %}secondary{% endif %} text-white">

    font-weight: 500;

    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);}      <div class="d-flex justify-content-between align-items-center">

    transition: all 0.2s ease;

    border: 1px solid #e2e8f0;        <h4 class="mb-0">

}

/* Back Button */          <i class="bi bi-{% if minute.event_type == 'decision' %}lightbulb{% elif minute.event_type == 'call' %}telephone{% elif minute.event_type == 'meeting' %}people{% elif minute.event_type == 'approval' %}check-circle{% elif minute.event_type == 'change' %}pencil{% elif minute.event_type == 'issue' %}exclamation-triangle{% elif minute.event_type == 'milestone' %}flag{% elif minute.event_type == 'email' %}envelope{% else %}chat-left-text{% endif %}"></i>

.btn-back-timeline:hover {

    background: #6366f1;.btn-back-timeline {          {{ minute.get_event_type_display }}

    color: white;

    border-color: #6366f1;  display: inline-flex;        </h4>

    transform: translateY(-2px);

}  align-items: center;        <span class="badge bg-white text-dark">



/* Main Card */  gap: 0.5rem;          {{ minute.event_date|date:"M d, Y - g:i A" }}

.minute-card {

    background: white;  padding: 0.75rem 1.25rem;        </span>

    border-radius: 20px;

    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);  background: white;      </div>

    overflow: hidden;

    max-width: 900px;  color: #475569;    </div>

    margin: 0 auto;

}  border-radius: 12px;    <div class="card-body p-4">



/* Card Header */  text-decoration: none;      <h3 class="mb-3">{{ minute.title }}</h3>

.minute-card-header {

    padding: 2rem;  font-weight: 500;      

    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);

    color: white;  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);      <div class="row g-3 mb-4">

    position: relative;

}  transition: all 0.2s ease;        <div class="col-md-6">



.minute-card-header.decision { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }  border: 1px solid #e2e8f0;          <div class="bg-light p-3 rounded">

.minute-card-header.call { background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%); }

.minute-card-header.email { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }}            <small class="text-muted d-block mb-1">Proyecto</small>

.minute-card-header.meeting { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }

.minute-card-header.approval { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }            <strong>{{ minute.project.name }}</strong>

.minute-card-header.change { background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%); }

.minute-card-header.issue { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }.btn-back-timeline:hover {          </div>

.minute-card-header.milestone { background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%); }

.minute-card-header.note { background: linear-gradient(135deg, #64748b 0%, #475569 100%); }  background: #6366f1;        </div>



.header-badge {  color: white;        <div class="col-md-6">

    display: inline-flex;

    align-items: center;  border-color: #6366f1;          <div class="bg-light p-3 rounded">

    gap: 0.5rem;

    padding: 0.5rem 1rem;  transform: translateY(-2px);            <small class="text-muted d-block mb-1">Creado por</small>

    background: rgba(255, 255, 255, 0.2);

    border-radius: 9999px;}            <strong>{{ minute.created_by.get_full_name|default:minute.created_by.username }}</strong>

    font-size: 0.85rem;

    font-weight: 600;            <small class="text-muted d-block">{{ minute.created_at|date:"M d, Y g:i A" }}</small>

    text-transform: uppercase;

    letter-spacing: 0.5px;/* Main Card */          </div>

    margin-bottom: 1rem;

}.minute-card {        </div>



.header-title {  background: white;      </div>

    font-size: 1.75rem;

    font-weight: 700;  border-radius: 20px;

    margin: 0 0 0.5rem 0;

}  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);      {% if minute.participants %}



.header-meta {  overflow: hidden;      <div class="mb-4">

    display: flex;

    flex-wrap: wrap;  max-width: 900px;        <h6 class="text-muted mb-2">Participantes</h6>

    gap: 1.5rem;

    opacity: 0.9;  margin: 0 auto;        <p class="mb-0">{{ minute.participants }}</p>

    font-size: 0.9rem;

}}      </div>



.header-meta-item {      {% endif %}

    display: flex;

    align-items: center;/* Card Header */

    gap: 0.5rem;

}.minute-card-header {      {% if minute.description %}



.private-indicator {  padding: 2rem;      <div class="mb-4">

    position: absolute;

    top: 1.5rem;  position: relative;        <h6 class="text-muted mb-2">Descripción</h6>

    right: 1.5rem;

    background: rgba(255, 255, 255, 0.25);  overflow: hidden;        <div class="border-start border-3 border-primary ps-3">

    padding: 0.4rem 0.75rem;

    border-radius: 8px;}          {{ minute.description|linebreaks }}

    font-size: 0.75rem;

    display: flex;        </div>

    align-items: center;

    gap: 0.4rem;.minute-card-header.decision { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); }      </div>

}

.minute-card-header.call { background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%); }      {% endif %}

/* Card Body */

.minute-card-body {.minute-card-header.email { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }

    padding: 2rem;

}.minute-card-header.meeting { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }      {% if minute.attachment %}



.section-label {.minute-card-header.approval { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }      <div class="mb-4">

    font-size: 0.75rem;

    text-transform: uppercase;.minute-card-header.change { background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%); }        <h6 class="text-muted mb-2">Archivo Adjunto</h6>

    letter-spacing: 0.5px;

    color: #64748b;.minute-card-header.issue { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }        <a href="{{ minute.attachment.url }}" target="_blank" class="btn btn-outline-primary">

    font-weight: 600;

    margin-bottom: 0.5rem;.minute-card-header.milestone { background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%); }          <i class="bi bi-paperclip"></i> Ver archivo adjunto

}

.minute-card-header.note { background: linear-gradient(135deg, #64748b 0%, #475569 100%); }        </a>

.description-content {

    font-size: 1rem;      </div>

    line-height: 1.7;

    color: #334155;.minute-card-header * {      {% endif %}

    white-space: pre-wrap;

}  color: white;



.participants-list {}      <div class="mt-4 pt-3 border-top">

    display: flex;

    flex-wrap: wrap;        <div class="d-flex justify-content-between align-items-center">

    gap: 0.5rem;

    margin-top: 0.5rem;.minute-header-type {          <div>

}

  display: inline-flex;            {% if not minute.visible_to_client %}

.participant-chip {

    display: inline-flex;  align-items: center;            <span class="badge bg-warning text-dark">

    align-items: center;

    gap: 0.4rem;  gap: 0.5rem;              <i class="bi bi-eye-slash"></i> Privado (solo Admin/PM)

    padding: 0.4rem 0.75rem;

    background: #f1f5f9;  padding: 0.5rem 1rem;            </span>

    border-radius: 9999px;

    font-size: 0.85rem;  background: rgba(255, 255, 255, 0.2);            {% else %}

    color: #475569;

}  border-radius: 9999px;            <span class="badge bg-success">



.attachment-card {  font-size: 0.85rem;              <i class="bi bi-eye"></i> Visible para cliente

    display: flex;

    align-items: center;  font-weight: 600;            </span>

    gap: 1rem;

    padding: 1rem 1.25rem;  text-transform: uppercase;            {% endif %}

    background: #f8fafc;

    border: 1px solid #e2e8f0;  letter-spacing: 0.5px;          </div>

    border-radius: 12px;

    margin-top: 0.5rem;  backdrop-filter: blur(10px);          {% if user.is_staff or user.is_superuser %}

    transition: all 0.2s ease;

}}          <div>



.attachment-card:hover {            <!-- Aquí podrías agregar botones de editar/eliminar en el futuro -->

    background: #eff6ff;

    border-color: #3b82f6;.minute-header-title {          </div>

}

  font-size: 1.75rem;          {% endif %}

.attachment-icon {

    width: 48px;  font-weight: 700;        </div>

    height: 48px;

    border-radius: 12px;  margin: 1.25rem 0 0.5rem 0;      </div>

    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);

    display: flex;  line-height: 1.3;    </div>

    align-items: center;

    justify-content: center;}  </div>

    color: white;

    font-size: 1.25rem;

}

.minute-header-date {  <!-- Navegación a otras minutas -->

.attachment-info {

    flex: 1;  font-size: 1rem;  <div class="mt-4 text-center">

}

  opacity: 0.9;    <a href="{% url 'project_minutes_list' minute.project.id %}" class="btn btn-primary">

.attachment-name {

    font-weight: 600;  display: flex;      Ver todas las minutas del proyecto

    color: #1e293b;

    margin: 0;  align-items: center;    </a>

}

  gap: 0.5rem;  </div>

.attachment-size {

    font-size: 0.8rem;}</div>

    color: #64748b;

}{% endblock %}



.attachment-download {.minute-header-actions {

    padding: 0.5rem 1rem;  position: absolute;

    background: #6366f1;  top: 1.5rem;

    color: white;  right: 1.5rem;

    border-radius: 8px;  display: flex;

    text-decoration: none;  gap: 0.5rem;

    font-weight: 500;}

    font-size: 0.85rem;

    transition: all 0.2s ease;.header-action-btn {

}  width: 40px;

  height: 40px;

.attachment-download:hover {  border-radius: 10px;

    background: #4f46e5;  background: rgba(255, 255, 255, 0.2);

    color: white;  border: none;

}  color: white;

  display: flex;

/* Divider */  align-items: center;

.section-divider {  justify-content: center;

    height: 1px;  cursor: pointer;

    background: #e2e8f0;  transition: all 0.2s;

    margin: 1.5rem 0;  text-decoration: none;

}}



/* Comments Section */.header-action-btn:hover {

.comments-section {  background: rgba(255, 255, 255, 0.3);

    padding: 2rem;  color: white;

    background: #f8fafc;}

    border-top: 1px solid #e2e8f0;

}.header-action-btn.delete:hover {

  background: #ef4444;

.comments-header {}

    display: flex;

    align-items: center;/* Card Body */

    justify-content: space-between;.minute-card-body {

    margin-bottom: 1.5rem;  padding: 2rem;

}}



.comments-title {/* Meta Info Grid */

    font-size: 1.1rem;.minute-meta-grid {

    font-weight: 600;  display: grid;

    color: #1e293b;  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));

    display: flex;  gap: 1rem;

    align-items: center;  margin-bottom: 2rem;

    gap: 0.5rem;}

}

.minute-meta-item {

.comments-count {  background: #f8fafc;

    background: #6366f1;  padding: 1rem 1.25rem;

    color: white;  border-radius: 12px;

    padding: 0.2rem 0.6rem;  border: 1px solid #e2e8f0;

    border-radius: 9999px;}

    font-size: 0.75rem;

}.minute-meta-label {

  font-size: 0.75rem;

/* Comment Item */  color: #94a3b8;

.comment-item {  text-transform: uppercase;

    background: white;  letter-spacing: 0.5px;

    border-radius: 12px;  margin-bottom: 0.25rem;

    padding: 1.25rem;}

    margin-bottom: 1rem;

    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);.minute-meta-value {

    border: 1px solid #e2e8f0;  font-size: 0.95rem;

}  color: #1e293b;

  font-weight: 500;

.comment-header {}

    display: flex;

    align-items: center;/* Description Section */

    gap: 0.75rem;.minute-description {

    margin-bottom: 0.75rem;  margin-bottom: 2rem;

}}



.comment-avatar {.minute-description h5 {

    width: 36px;  font-size: 0.85rem;

    height: 36px;  color: #64748b;

    border-radius: 50%;  text-transform: uppercase;

    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);  letter-spacing: 0.5px;

    display: flex;  margin-bottom: 1rem;

    align-items: center;}

    justify-content: center;

    color: white;.minute-description-content {

    font-weight: 600;  background: #f8fafc;

    font-size: 0.85rem;  padding: 1.5rem;

}  border-radius: 12px;

  border-left: 4px solid #6366f1;

.comment-author {  color: #334155;

    font-weight: 600;  line-height: 1.7;

    color: #1e293b;}

    font-size: 0.9rem;

}/* Attachment */

.minute-attachment {

.comment-date {  margin-bottom: 2rem;

    font-size: 0.75rem;}

    color: #94a3b8;

}.attachment-link {

  display: inline-flex;

.comment-content {  align-items: center;

    color: #475569;  gap: 0.75rem;

    line-height: 1.6;  padding: 1rem 1.5rem;

    font-size: 0.95rem;  background: #f1f5f9;

}  border-radius: 12px;

  color: #475569;

/* Comment Form */  text-decoration: none;

.comment-form {  transition: all 0.2s;

    margin-top: 1.5rem;}

    background: white;

    border-radius: 12px;.attachment-link:hover {

    padding: 1.25rem;  background: #e2e8f0;

    border: 1px solid #e2e8f0;  color: #1e293b;

}}



.comment-textarea {.attachment-icon {

    width: 100%;  width: 40px;

    padding: 0.875rem;  height: 40px;

    border: 2px solid #e2e8f0;  background: #6366f1;

    border-radius: 10px;  color: white;

    font-size: 0.95rem;  border-radius: 10px;

    resize: none;  display: flex;

    transition: all 0.2s ease;  align-items: center;

    min-height: 100px;  justify-content: center;

}}



.comment-textarea:focus {/* Visibility Badge */

    outline: none;.visibility-badge {

    border-color: #6366f1;  display: inline-flex;

    box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);  align-items: center;

}  gap: 0.4rem;

  padding: 0.5rem 1rem;

.comment-submit {  border-radius: 9999px;

    margin-top: 1rem;  font-size: 0.85rem;

    padding: 0.75rem 1.5rem;  font-weight: 500;

    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);}

    color: white;

    border: none;.visibility-badge.public {

    border-radius: 10px;  background: #dcfce7;

    font-weight: 600;  color: #166534;

    cursor: pointer;}

    transition: all 0.2s ease;

    display: inline-flex;.visibility-badge.private {

    align-items: center;  background: #fef3c7;

    gap: 0.5rem;  color: #92400e;

}}



.comment-submit:hover {/* Comments Section */

    transform: translateY(-2px);.minute-comments {

    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);  margin-top: 2rem;

}  padding-top: 2rem;

  border-top: 1px solid #e2e8f0;

/* Action Buttons */}

.action-buttons {

    display: flex;.comments-header {

    gap: 0.75rem;  display: flex;

    padding: 1.5rem 2rem;  align-items: center;

    background: white;  justify-content: space-between;

    border-top: 1px solid #e2e8f0;  margin-bottom: 1.5rem;

}}



.btn-action {.comments-header h5 {

    padding: 0.75rem 1.25rem;  font-size: 1.1rem;

    border-radius: 10px;  font-weight: 600;

    font-weight: 600;  color: #1e293b;

    font-size: 0.9rem;  margin: 0;

    display: inline-flex;}

    align-items: center;

    gap: 0.5rem;.comments-count {

    transition: all 0.2s ease;  background: #e0e7ff;

    text-decoration: none;  color: #4338ca;

    border: none;  padding: 0.25rem 0.75rem;

    cursor: pointer;  border-radius: 9999px;

}  font-size: 0.85rem;

  font-weight: 600;

.btn-edit {}

    background: #f1f5f9;

    color: #475569;/* Comment Item */

}.comment-item {

  display: flex;

.btn-edit:hover {  gap: 1rem;

    background: #e2e8f0;  margin-bottom: 1.25rem;

    color: #1e293b;  padding-bottom: 1.25rem;

}  border-bottom: 1px solid #f1f5f9;

}

.btn-delete {

    background: #fef2f2;.comment-item:last-child {

    color: #dc2626;  border-bottom: none;

}  margin-bottom: 0;

  padding-bottom: 0;

.btn-delete:hover {}

    background: #fee2e2;

}.comment-avatar {

  width: 40px;

/* Empty Comments */  height: 40px;

.comments-empty {  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);

    text-align: center;  color: white;

    padding: 2rem;  border-radius: 50%;

    color: #94a3b8;  display: flex;

}  align-items: center;

  justify-content: center;

.comments-empty i {  font-weight: 600;

    font-size: 2.5rem;  font-size: 0.9rem;

    margin-bottom: 0.75rem;  flex-shrink: 0;

    display: block;}

}

.comment-content {

/* Delete Modal */  flex: 1;

.delete-modal {}

    position: fixed;

    top: 0;.comment-header {

    left: 0;  display: flex;

    right: 0;  align-items: center;

    bottom: 0;  justify-content: space-between;

    background: rgba(0, 0, 0, 0.5);  margin-bottom: 0.5rem;

    display: none;}

    align-items: center;

    justify-content: center;.comment-author {

    z-index: 1000;  font-weight: 600;

}  color: #1e293b;

  font-size: 0.9rem;

.delete-modal.show {}

    display: flex;

}.comment-date {

  font-size: 0.8rem;

.delete-modal-content {  color: #94a3b8;

    background: white;}

    border-radius: 16px;

    padding: 2rem;.comment-text {

    max-width: 400px;  color: #475569;

    text-align: center;  line-height: 1.6;

    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);  font-size: 0.9rem;

}}



.delete-modal-icon {.comment-delete {

    width: 64px;  color: #ef4444;

    height: 64px;  font-size: 0.8rem;

    background: #fee2e2;  text-decoration: none;

    border-radius: 50%;  opacity: 0;

    display: flex;  transition: opacity 0.2s;

    align-items: center;}

    justify-content: center;

    margin: 0 auto 1.5rem;.comment-item:hover .comment-delete {

    color: #dc2626;  opacity: 1;

    font-size: 1.75rem;}

}

/* Comment Form */

.delete-modal-title {.comment-form {

    font-size: 1.25rem;  margin-top: 1.5rem;

    font-weight: 600;  background: #f8fafc;

    color: #1e293b;  padding: 1.25rem;

    margin-bottom: 0.5rem;  border-radius: 12px;

}}



.delete-modal-text {.comment-form textarea {

    color: #64748b;  width: 100%;

    margin-bottom: 1.5rem;  padding: 0.75rem 1rem;

}  border: 1px solid #e2e8f0;

  border-radius: 10px;

.delete-modal-actions {  resize: none;

    display: flex;  font-size: 0.9rem;

    gap: 0.75rem;  transition: border-color 0.2s;

    justify-content: center;}

}

.comment-form textarea:focus {

.btn-cancel-delete {  outline: none;

    padding: 0.75rem 1.5rem;  border-color: #6366f1;

    background: #f1f5f9;}

    color: #475569;

    border: none;.comment-form-actions {

    border-radius: 10px;  display: flex;

    font-weight: 600;  justify-content: flex-end;

    cursor: pointer;  margin-top: 0.75rem;

}}



.btn-confirm-delete {.btn-comment {

    padding: 0.75rem 1.5rem;  padding: 0.6rem 1.25rem;

    background: #dc2626;  background: #6366f1;

    color: white;  color: white;

    border: none;  border: none;

    border-radius: 10px;  border-radius: 8px;

    font-weight: 600;  font-weight: 500;

    cursor: pointer;  cursor: pointer;

}  transition: background 0.2s;

}

/* Responsive */

@media (max-width: 768px) {.btn-comment:hover {

    .minute-detail-wrapper {  background: #4f46e5;

        padding: 1rem;}

    }

    /* Delete Modal */

    .minute-card-header {.delete-modal {

        padding: 1.5rem;  position: fixed;

    }  inset: 0;

      background: rgba(0, 0, 0, 0.5);

    .header-title {  display: none;

        font-size: 1.35rem;  align-items: center;

    }  justify-content: center;

      z-index: 1000;

    .header-meta {}

        flex-direction: column;

        gap: 0.75rem;.delete-modal.show {

    }  display: flex;

    }

    .minute-card-body,

    .comments-section,.delete-modal-content {

    .action-buttons {  background: white;

        padding: 1.25rem;  padding: 2rem;

    }  border-radius: 16px;

}  max-width: 400px;

</style>  text-align: center;

{% endblock %}}



{% block content %}.delete-modal-icon {

<div class="minute-detail-wrapper">  width: 60px;

    <!-- Back Button -->  height: 60px;

    <div style="max-width: 900px; margin: 0 auto 1.5rem;">  background: #fee2e2;

        <a href="{% url 'project_minutes_list' minute.project.id %}" class="btn-back-timeline">  color: #ef4444;

            <i class="bi bi-arrow-left"></i>  border-radius: 50%;

            {% trans "Back to Timeline" %}  display: flex;

        </a>  align-items: center;

    </div>  justify-content: center;

      margin: 0 auto 1rem auto;

    <!-- Main Card -->  font-size: 1.5rem;

    <div class="minute-card">}

        <!-- Header -->

        <div class="minute-card-header {{ minute.event_type }}">.delete-modal-actions {

            {% if not minute.visible_to_client %}  display: flex;

            <div class="private-indicator">  gap: 1rem;

                <i class="bi bi-eye-slash"></i>  justify-content: center;

                {% trans "Private" %}  margin-top: 1.5rem;

            </div>}

            {% endif %}

            .btn-cancel {

            <span class="header-badge">  padding: 0.6rem 1.5rem;

                <i class="bi bi-{% if minute.event_type == 'decision' %}lightbulb{% elif minute.event_type == 'call' %}telephone{% elif minute.event_type == 'meeting' %}people{% elif minute.event_type == 'approval' %}check-circle{% elif minute.event_type == 'change' %}pencil{% elif minute.event_type == 'issue' %}exclamation-triangle{% elif minute.event_type == 'milestone' %}flag{% elif minute.event_type == 'email' %}envelope{% else %}chat-left-text{% endif %}"></i>  background: #f1f5f9;

                {{ minute.get_event_type_display }}  color: #475569;

            </span>  border: none;

              border-radius: 8px;

            <h1 class="header-title">{{ minute.title }}</h1>  cursor: pointer;

            }

            <div class="header-meta">

                <span class="header-meta-item">.btn-delete {

                    <i class="bi bi-calendar3"></i>  padding: 0.6rem 1.5rem;

                    {{ minute.event_date|date:"F d, Y - g:i A" }}  background: #ef4444;

                </span>  color: white;

                <span class="header-meta-item">  border: none;

                    <i class="bi bi-person-circle"></i>  border-radius: 8px;

                    {{ minute.created_by.get_full_name|default:minute.created_by.username }}  cursor: pointer;

                </span>}

                <span class="header-meta-item">

                    <i class="bi bi-folder"></i>/* Responsive */

                    {{ minute.project.name }}@media (max-width: 768px) {

                </span>  .minute-detail-wrapper {

            </div>    padding: 1rem;

        </div>  }

          

        <!-- Body -->  .minute-card-header {

        <div class="minute-card-body">    padding: 1.5rem;

            {% if minute.participants %}  }

            <div class="mb-4">  

                <p class="section-label">{% trans "Participants" %}</p>  .minute-header-title {

                <div class="participants-list">    font-size: 1.25rem;

                    {% for participant in minute.participants.split %}  }

                    <span class="participant-chip">  

                        <i class="bi bi-person"></i>  .minute-header-actions {

                        {{ participant|cut:"," }}    position: static;

                    </span>    margin-top: 1rem;

                    {% endfor %}  }

                </div>  

            </div>  .minute-card-body {

            {% endif %}    padding: 1.5rem;

              }

            <div>}

                <p class="section-label">{% trans "Description" %}</p></style>

                <div class="description-content">{{ minute.description|linebreaks }}</div>{% endblock %}

            </div>

            {% block content %}

            {% if minute.attachment %}<div class="minute-detail-wrapper">

            <div class="section-divider"></div>  <div class="container">

            <div>    <!-- Back Button -->

                <p class="section-label">{% trans "Attachment" %}</p>    <a href="{% url 'project_minutes_list' minute.project.id %}" class="btn-back-timeline mb-4">

                <div class="attachment-card">      <i class="bi bi-arrow-left"></i> Volver al Timeline

                    <div class="attachment-icon">    </a>

                        <i class="bi bi-file-earmark"></i>

                    </div>    <!-- Main Card -->

                    <div class="attachment-info">    <div class="minute-card">

                        <p class="attachment-name">{{ minute.attachment.name|cut:"minutes/" }}</p>      <!-- Header -->

                    </div>      <div class="minute-card-header {{ minute.event_type }}">

                    <a href="{{ minute.attachment.url }}" target="_blank" class="attachment-download">        {% if can_edit %}

                        <i class="bi bi-download"></i> {% trans "Download" %}        <div class="minute-header-actions">

                    </a>          <a href="{% url 'project_minute_edit' minute.id %}" class="header-action-btn" title="Editar">

                </div>            <i class="bi bi-pencil"></i>

            </div>          </a>

            {% endif %}          <button type="button" class="header-action-btn delete" title="Eliminar" onclick="showDeleteModal()">

        </div>            <i class="bi bi-trash"></i>

                  </button>

        <!-- Action Buttons (admin only) -->        </div>

        {% if can_edit %}        {% endif %}

        <div class="action-buttons">

            <a href="{% url 'project_minute_edit' minute.id %}" class="btn-action btn-edit">        <span class="minute-header-type">

                <i class="bi bi-pencil"></i>          <i class="bi bi-{% if minute.event_type == 'decision' %}lightbulb{% elif minute.event_type == 'call' %}telephone{% elif minute.event_type == 'meeting' %}people{% elif minute.event_type == 'approval' %}check-circle{% elif minute.event_type == 'change' %}pencil{% elif minute.event_type == 'issue' %}exclamation-triangle{% elif minute.event_type == 'milestone' %}flag{% elif minute.event_type == 'email' %}envelope{% else %}chat-left-text{% endif %}"></i>

                {% trans "Edit" %}          {{ minute.get_event_type_display }}

            </a>        </span>

            <button type="button" class="btn-action btn-delete" onclick="showDeleteModal()">

                <i class="bi bi-trash"></i>        <h1 class="minute-header-title">{{ minute.title }}</h1>

                {% trans "Delete" %}

            </button>        <div class="minute-header-date">

        </div>          <i class="bi bi-calendar3"></i>

        {% endif %}          {{ minute.event_date|date:"l, F d, Y" }} • {{ minute.event_date|date:"g:i A" }}

                </div>

        <!-- Comments Section -->      </div>

        <div class="comments-section">

            <div class="comments-header">      <!-- Body -->

                <h3 class="comments-title">      <div class="minute-card-body">

                    <i class="bi bi-chat-dots"></i>        <!-- Meta Info -->

                    {% trans "Comments" %}        <div class="minute-meta-grid">

                    {% if comments %}          <div class="minute-meta-item">

                    <span class="comments-count">{{ comments.count }}</span>            <div class="minute-meta-label">Proyecto</div>

                    {% endif %}            <div class="minute-meta-value">{{ minute.project.name }}</div>

                </h3>          </div>

            </div>          <div class="minute-meta-item">

                        <div class="minute-meta-label">Creado por</div>

            {% if comments %}            <div class="minute-meta-value">{{ minute.created_by.get_full_name|default:minute.created_by.username }}</div>

            <div class="comments-list">          </div>

                {% for comment in comments %}          <div class="minute-meta-item">

                <div class="comment-item">            <div class="minute-meta-label">Fecha de creación</div>

                    <div class="comment-header">            <div class="minute-meta-value">{{ minute.created_at|date:"M d, Y - g:i A" }}</div>

                        <div class="comment-avatar">          </div>

                            {{ comment.author.first_name.0|default:comment.author.username.0|upper }}          <div class="minute-meta-item">

                        </div>            <div class="minute-meta-label">Visibilidad</div>

                        <div>            <div class="minute-meta-value">

                            <div class="comment-author">{{ comment.author.get_full_name|default:comment.author.username }}</div>              {% if minute.visible_to_client %}

                            <div class="comment-date">{{ comment.created_at|date:"M d, Y - g:i A" }}</div>              <span class="visibility-badge public">

                        </div>                <i class="bi bi-eye"></i> Visible para cliente

                    </div>              </span>

                    <div class="comment-content">{{ comment.content|linebreaks }}</div>              {% else %}

                </div>              <span class="visibility-badge private">

                {% endfor %}                <i class="bi bi-eye-slash"></i> Solo Admin/PM

            </div>              </span>

            {% else %}              {% endif %}

            <div class="comments-empty">            </div>

                <i class="bi bi-chat"></i>          </div>

                <p>{% trans "No comments yet. Be the first to comment!" %}</p>        </div>

            </div>

            {% endif %}        {% if minute.participants %}

                    <div class="minute-meta-grid" style="margin-bottom: 2rem;">

            <!-- Add Comment Form -->          <div class="minute-meta-item" style="grid-column: 1 / -1;">

            <form action="{% url 'minute_comment_add' minute.id %}" method="post" class="comment-form">            <div class="minute-meta-label">Participantes</div>

                {% csrf_token %}            <div class="minute-meta-value">{{ minute.participants }}</div>

                <input type="hidden" name="next" value="detail">          </div>

                <textarea name="content" class="comment-textarea" placeholder="{% trans 'Write a comment...' %}" required></textarea>        </div>

                <button type="submit" class="comment-submit">        {% endif %}

                    <i class="bi bi-send"></i>

                    {% trans "Post Comment" %}        <!-- Description -->

                </button>        {% if minute.description %}

            </form>        <div class="minute-description">

        </div>          <h5><i class="bi bi-text-left"></i> Descripción</h5>

    </div>          <div class="minute-description-content">

</div>            {{ minute.description|linebreaks }}

          </div>

<!-- Delete Confirmation Modal -->        </div>

<div class="delete-modal" id="deleteModal">        {% endif %}

    <div class="delete-modal-content">

        <div class="delete-modal-icon">        <!-- Attachment -->

            <i class="bi bi-exclamation-triangle"></i>        {% if minute.attachment %}

        </div>        <div class="minute-attachment">

        <h4 class="delete-modal-title">{% trans "Delete Minute?" %}</h4>          <h5 class="mb-3" style="font-size: 0.85rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">

        <p class="delete-modal-text">{% trans "This action cannot be undone. All comments will also be deleted." %}</p>            <i class="bi bi-paperclip"></i> Archivo Adjunto

        <div class="delete-modal-actions">          </h5>

            <button type="button" class="btn-cancel-delete" onclick="hideDeleteModal()">          <a href="{{ minute.attachment.url }}" target="_blank" class="attachment-link">

                {% trans "Cancel" %}            <span class="attachment-icon">

            </button>              <i class="bi bi-file-earmark"></i>

            <form action="{% url 'project_minute_delete' minute.id %}" method="post" style="display: inline;">            </span>

                {% csrf_token %}            <span>Ver archivo adjunto</span>

                <button type="submit" class="btn-confirm-delete">          </a>

                    {% trans "Delete" %}        </div>

                </button>        {% endif %}

            </form>

        </div>        <!-- Comments Section -->

    </div>        <div class="minute-comments">

</div>          <div class="comments-header">

            <h5><i class="bi bi-chat-dots me-2"></i>Comentarios</h5>

<script>            <span class="comments-count">{{ comments.count }}</span>

function showDeleteModal() {          </div>

    document.getElementById('deleteModal').classList.add('show');

}          {% for comment in comments %}

          <div class="comment-item">

function hideDeleteModal() {            <div class="comment-avatar">

    document.getElementById('deleteModal').classList.remove('show');              {{ comment.author.first_name|slice:":1"|upper }}{{ comment.author.last_name|slice:":1"|upper }}

}            </div>

            <div class="comment-content">

// Close modal on outside click              <div class="comment-header">

document.getElementById('deleteModal').addEventListener('click', function(e) {                <span class="comment-author">{{ comment.author.get_full_name|default:comment.author.username }}</span>

    if (e.target === this) {                <div class="d-flex align-items-center gap-3">

        hideDeleteModal();                  <span class="comment-date">{{ comment.created_at|timesince }} ago</span>

    }                  {% if user == comment.author or user.is_staff or user.is_superuser %}

});                  <form action="{% url 'minute_comment_delete' comment.id %}" method="post" class="d-inline" onsubmit="return confirm('¿Eliminar este comentario?');">

                    {% csrf_token %}

// Close modal on escape key                    <button type="submit" class="comment-delete" style="background: none; border: none; cursor: pointer;">

document.addEventListener('keydown', function(e) {                      <i class="bi bi-trash"></i>

    if (e.key === 'Escape') {                    </button>

        hideDeleteModal();                  </form>

    }                  {% endif %}

});                </div>

</script>              </div>

{% endblock %}              <div class="comment-text">{{ comment.content|linebreaks }}</div>

            </div>
          </div>
          {% empty %}
          <p class="text-muted text-center py-3">No hay comentarios aún. ¡Sé el primero en comentar!</p>
          {% endfor %}

          <!-- Comment Form -->
          <form action="{% url 'minute_comment_add' minute.id %}" method="post" class="comment-form">
            {% csrf_token %}
            <textarea name="content" rows="3" placeholder="Escribe un comentario..." required></textarea>
            <div class="comment-form-actions">
              <button type="submit" class="btn-comment">
                <i class="bi bi-send me-1"></i> Comentar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
{% if can_edit %}
<div class="delete-modal" id="deleteModal">
  <div class="delete-modal-content">
    <div class="delete-modal-icon">
      <i class="bi bi-exclamation-triangle"></i>
    </div>
    <h4>¿Eliminar esta minuta?</h4>
    <p class="text-muted">Esta acción no se puede deshacer. Se eliminarán también todos los comentarios asociados.</p>
    <div class="delete-modal-actions">
      <button type="button" class="btn-cancel" onclick="hideDeleteModal()">Cancelar</button>
      <form action="{% url 'project_minute_delete' minute.id %}" method="post" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn-delete">Eliminar</button>
      </form>
    </div>
  </div>
</div>

<script>
function showDeleteModal() {
  document.getElementById('deleteModal').classList.add('show');
}

function hideDeleteModal() {
  document.getElementById('deleteModal').classList.remove('show');
}

// Close modal on outside click
document.getElementById('deleteModal').addEventListener('click', function(e) {
  if (e.target === this) {
    hideDeleteModal();
  }
});
</script>
{% endif %}
{% endblock %}
