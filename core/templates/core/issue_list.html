{% extends "core/base_modern.html" %}
{% load i18n %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0"><i class="bi bi-exclamation-triangle"></i> {% trans 'Alertas / Daños' %} – {{ project.name }}</h2>
    <a href="{% url 'project_overview' project.id %}" class="btn btn-outline-secondary btn-sm"><i class="bi bi-arrow-left"></i> {% trans 'Volver' %}</a>
  </div>
  {% if form %}
  <div id="crear" class="card mb-4">
    <div class="card-header"><i class="bi bi-plus-circle"></i> {% trans 'Crear alerta/daño' %}</div>
    <div class="card-body">
      <form method="post" class="row g-3">
        {% csrf_token %}
        <div class="col-md-6">{{ form.title.label_tag }}{{ form.title }}</div>
        <div class="col-md-6">{{ form.severity.label_tag }}{{ form.severity }}</div>
        <div class="col-12">{{ form.description.label_tag }}{{ form.description }}</div>
        <div class="col-md-6">{{ form.status.label_tag }}{{ form.status }}</div>
        <div class="col-12"><button class="btn btn-primary">{% trans 'Guardar' %}</button></div>
      </form>
    </div>
  </div>
  {% endif %}

  <div class="list-group">
    {% for i in issues %}
      <div class="list-group-item d-flex justify-content-between align-items-start">
        <div>
          <h6 class="mb-1">{{ i.title }}</h6>
          <div class="small text-muted">{{ i.created_at|date:'Y-m-d' }} · {{ i.get_status_display|default:i.status }}</div>
          {% if i.description %}<div class="mt-1">{{ i.description }}</div>{% endif %}
        </div>
        <span class="badge bg-warning text-dark">{{ i.severity }}</span>
      </div>
    {% empty %}
      <div class="text-center py-5 text-muted"><i class="bi bi-shield-check display-6"></i><div class="mt-2">{% trans 'Sin reportes' %}</div></div>
    {% endfor %}
  </div>
</div>
{% endblock %}