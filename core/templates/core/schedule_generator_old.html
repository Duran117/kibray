{% extends "core/base_modern.html" %}
{% load i18n %}

{% block title %}{% trans "Schedule Generator" %}{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto p-6">
  <div class="rounded-xl border border-amber-200 bg-amber-50 p-5">
    <h1 class="text-lg font-semibold text-amber-900">{% trans "Legacy template disabled" %}</h1>
    <p class="mt-2 text-sm text-amber-800">
      {% trans "This legacy schedule generator template has been retired. Use the current schedule generator instead." %}
    </p>
    {% if project %}
      <div class="mt-4">
        <a class="inline-flex items-center rounded-lg bg-kibray-600 px-4 py-2 text-white hover:bg-kibray-700"
           href="{% url 'schedule_generator' project.id %}">
          {% trans "Go to Schedule Generator" %}
        </a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
{% if can_manage %}
<div class="modal fade" id="createCategoryModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="action" value="create_category">
                <div class="modal-header">
                    <h5 class="modal-title">{% trans "Nueva Categoría" %}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    {{ category_form.as_p }}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans "Cancelar" %}</button>
                    <button type="submit" class="btn btn-primary">{% trans "Crear" %}</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal: Create Item -->
<div class="modal fade" id="createItemModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="action" value="create_item">
                <div class="modal-header">
                    <h5 class="modal-title">{% trans "Nuevo Ítem" %}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">{% trans "Categoría existente" %}</label>
                            {{ item_form.category }}
                            <div class="form-text">{% trans "O crea una nueva categoría abajo" %}</div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">{% trans "Nueva categoría (opcional)" %}</label>
                            <input type="text" name="new_category_name" class="form-control" placeholder="Ej: Preparación Fina">
                            <div class="form-text">{% trans "Si completas este campo se ignorará la selección de arriba." %}</div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">{% trans "Título" %}</label>
                            {{ item_form.title }}
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">{% trans "Orden" %}</label>
                            {{ item_form.order }}
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">{% trans "Estado" %}</label>
                            {{ item_form.status }}
                        </div>
                        <div class="col-md-12">
                            <label class="form-label">{% trans "Descripción" %}</label>
                            {{ item_form.description }}
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">{% trans "Inicio plan." %}</label>
                            {{ item_form.planned_start }}
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">{% trans "Fin plan." %}</label>
                            {{ item_form.planned_end }}
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">{% trans "% Completado (manual)" %}</label>
                            {{ item_form.percent_complete }}
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">{% trans "Cost Code" %}</label>
                            {{ item_form.cost_code }}
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">{% trans "Budget Line" %}</label>
                            {{ item_form.budget_line }}
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">{% trans "Estimate Line" %}</label>
                            {{ item_form.estimate_line }}
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans "Cancelar" %}</button>
                    <button type="submit" class="btn btn-primary">{% trans "Crear" %}</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}
