import{r as s,j as e,c as E,R as w}from"./index.3v2dhZMc.js";const h={urgent:3,high:2,medium:1,low:0};function S(){const[a,j]=s.useState(""),[l,c]=s.useState(!1),[u,p]=s.useState(null),[i,x]=s.useState({Pendiente:[],"En Progreso":[],Completada:[],Cancelada:[]}),[y,b]=s.useState(0),m=async()=>{c(!0),p(null);try{const t=new URL("/api/v1/tasks/touchup_board/",window.location.origin);a&&t.searchParams.set("project",a);const o=await fetch(t.toString(),{headers:{Accept:"application/json"},credentials:"include"});if(!o.ok)throw new Error(`HTTP ${o.status}`);const n=await o.json();x(n.columns||{}),b(n.total||0)}catch(t){p(t.message||"Error loading board")}finally{c(!1)}};s.useEffect(()=>{m()},[a]),s.useEffect(()=>{const t=document.getElementById("touchup-root");t?(t.setAttribute("data-mounted","1"),console.log("[TouchupBoard] Component mounted, data-mounted=1")):console.log("[TouchupBoard] Component mount effect: root not found")},[]);const R=s.useMemo(()=>{const t=n=>Array.isArray(n)?[...n].sort((r,d)=>{const f=h[d.priority]-h[r.priority];if(f!==0)return f;const T=r.due_date?new Date(r.due_date).getTime():0,C=d.due_date?new Date(d.due_date).getTime():0;return T-C}):[],o={};return i&&typeof i=="object"&&Object.entries(i).forEach(([n,r])=>o[n]=t(r)),o},[i]);return e.jsxs("div",{className:"touchup-board",children:[e.jsxs("div",{className:"toolbar",children:[e.jsx("input",{placeholder:"Project ID",value:a,onChange:t=>j(t.target.value),style:{padding:"6px 8px",marginRight:8}}),e.jsx("button",{onClick:m,disabled:l,children:l?"Loading…":"Refresh"}),e.jsxs("span",{style:{marginLeft:12},children:["Total: ",y]}),u&&e.jsx("span",{style:{marginLeft:12,color:"red"},children:u})]}),e.jsx("div",{className:"columns",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16,marginTop:16},children:["Pendiente","En Progreso","Completada","Cancelada"].map(t=>e.jsxs("div",{className:"column",style:{background:"#f7f7f8",borderRadius:8,padding:12},children:[e.jsx("h3",{style:{marginTop:0},children:t}),e.jsx("div",{className:"cards",style:{display:"flex",flexDirection:"column",gap:8},children:(R[t]||[]).map(o=>e.jsxs("div",{className:"card",style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,padding:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("strong",{children:["#",o.id," ",o.title]}),e.jsx("span",{title:"Priority",style:{fontSize:12},children:o.priority.toUpperCase()})]}),e.jsxs("div",{style:{fontSize:12,color:"#555"},children:["Due: ",o.due_date?new Date(o.due_date).toLocaleDateString():"—"]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("button",{style:{fontSize:12},children:"View"}),e.jsx("button",{style:{fontSize:12},children:"Assign"}),e.jsx("button",{style:{fontSize:12},children:"Complete"})]})]},o.id))})]},t))})]})}const g=document.getElementById("touchup-root");g?(console.log("[TouchupBoard] Root element found, mounting React app"),E.createRoot(g).render(e.jsx(w.StrictMode,{children:e.jsx(S,{})}))):console.error("[TouchupBoard] ERROR: #touchup-root element not found at script execution");
